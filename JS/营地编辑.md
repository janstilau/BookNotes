# 营地信息编辑需求

## 数据结构

```c++
class CampManager { // 模仿CityManager，并且一样托付BusinessManager管理
  QMap<int, CampInfo> mCamps;
}

class CampInfo {
  int mCoordId;
  int mType;
  QRegion mRegion;
  int mCooldown;
  int mBuffId;
  int mBuffDuration;
  int mNpcId;
  int mGroupNum;
  int mGoOutFrequency;
  int mSeigeValue;
  int mEffectId;
  int mDamagePercent;
}

class CampInfoTool {
  enum { CampSelecting, RegionEditing } mMode;

  // 无论哪个模式下，都弹出属性面板，类似城市信息属性编辑，包括CampInfo的所有属性

  // 在SelectCamp模式，模仿城市编辑工具(TileCellInfoTool)处理
  // 在RegionEditing模式，模仿选取编辑工具(TileSelectionTool)处理
}
```

## 事项

* 注意业务相关代码使用HOOLAI_BUSINESS宏
* 把TileSelectionItem的主要代码抽象出一个更基础的基类RegionGraphItem，配置颜色和区域即可绘制，现有的TileSelectionItem和新加的CampRegionItem都继承自它。
* 把TileSelectionTool的主要代码抽象出一个更基础的基类TileRegionEditTool, 现有的TileSelectionTool和新加的CampInfoTool都继承或引用它。
* 属性编辑窗口模仿城市属性编辑窗口，添加6个按钮(详见下面的菜单项)
* 选中一个营地时，用CampRegionItem绘制它的对应区域，并清除其他营地区域的显示
* 导入导出为csv格式，模仿CityManager::ImportCities/ExportCities

| 字段            | 说明                                    |
|----------------|-----------------------------------------|
| Id             | 自动生成                                 |
| MapId          | 取地图的MapId                            |
| CoordId        |                                         |
| Type           | 由绘制在营地层的图块id决定,做成下拉列表       |
| Region         | 逗号','连接的coordId字符串,无空格           |
| CooldownSecond |                                          |
| BuffId         |                                          |
| BuffDuration   |                                          |
| NpcId          |                                          |
| GroupNum       |                                          |
| GoOutFrequency |                                          |
| SiegeValue     |                                          |
| EffectId       |                                          |
| DamagePercent  |                                          |

## 菜单项

* 加载营地信息文件...
* 导入营地信息文件...
* 下一个营地
* 上一个营地
* 营地工具模式
  * 营地选择模式
  * 区域编辑模式
